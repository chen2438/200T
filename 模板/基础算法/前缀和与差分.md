## 前缀和



## 差分

### 差分数组

原数组 a, 构造数组 b.

使得 a[i] = b[1] + b[2] + b[3] + ... + b[i].

a 是 b 的前缀和, b 是 a 的差分.

差分可以看成前缀和的逆运算.

### 构造

定义法:

```cpp
b[1]=a[1]
b[2]=a[2]-a[1]
b[3]=a[3]-a[2]
...
b[n-1]=a[n-1]-a[n-2]
b[n]=a[n]-a[n-1]
->
a[n]=b[1]+ ... +b[n]
```

定义法等价于对 b[i, i] += a[i]:

```cpp
void insert(int l, int r, int c){
    b[l] += c;
    b[r + 1] -= c;
}
insert(i, i, a[i]);
```

### 区间修改

$a[l, r] += c <=> b[l] += c, b[r+1] -= c$

### AcWing 797. 差分

https://www.acwing.com/problem/content/799/

![image-20220704101625795](http://nme-200t.oss-cn-hangzhou.aliyuncs.com/notes/2022-07-04-021625.png)

![image-20220704101636973](http://nme-200t.oss-cn-hangzhou.aliyuncs.com/notes/2022-07-04-021637.png)

```cpp
#include<bits/stdc++.h>
#define FOR(i,a,b) for(int i=(a);i<=(b);++i)
using namespace std;

const int N = 100010;

int n, m;
int a[N], b[N];

void insert(int l, int r, int c){
    b[l] += c;
    b[r + 1] -= c;
}

int main(){
    cin.tie(0)->sync_with_stdio(0);
    cin>>n>>m;
    FOR(i,1,n){
        cin>>a[i];
        insert(i, i, a[i]);
    }
    while (m -- ){
        int l, r, c;
        cin>>l>>r>>c;
        insert(l, r, c);
    }
    FOR(i,1,n){
        a[i] = b[i] += b[i - 1];
        cout<<a[i]<<' ';
    }
    return 0;
}
```

