### AcWing 2492. HH的项链

#### 题目描述

![image-20220809150625797](https://media.opennet.top/i/2023/01/09/63bb974001117.png)

![image-20220809150634852](https://media.opennet.top/i/2023/01/09/63bb974099123.png)

#### 代码

```cpp
#pragma GCC optimize(3)
#include<bits/stdc++.h>
#define FOR(i,a,b) for(int i=(a);i<=(b);++i)
#define ROF(i,a,b) for(int i=(a);i>=(b);--i)
#define endl '\n'
using namespace std;

const int N = 50010, M = 200010, S = 1000010;

int n, m, len;
int w[N], bel[N], ans[M];
struct Query{
    int id, l, r;
    bool operator<(const Query &y)const{
        int i = bel[l], j = bel[y.l];
        if(i != j) return i < j;
        if(i%2) return r<y.r;
        return r>y.r;
    }
}q[M];
int cnt[S];

void add(int x, int& res){
    if (!cnt[x]) res ++ ;
    cnt[x] ++ ;
}

void del(int x, int& res){
    cnt[x] -- ;
    if (!cnt[x]) res -- ;
}

void solve(){
    cin>>n;
    FOR(i,1,n) cin>>w[i];
    cin>>m;
    len = max(1, (int)sqrt((double)n * n / m));
    FOR(i,1,n) bel[i]=i/len;
    FOR(i,0,m-1){
        int l, r; cin>>l>>r;
        q[i] = {i, l, r};
    }
    sort(q, q + m);
    for (int k = 0, i = 0, j = 1, res = 0; k < m; k ++ ){
        int id = q[k].id, l = q[k].l, r = q[k].r;
        while (i < r) add(w[ ++ i], res);
        while (i > r) del(w[i -- ], res);
        while (j < l) del(w[j ++ ], res);
        while (j > l) add(w[ -- j], res);
        ans[id] = res;
    }
    FOR(i,0,m-1) cout<<ans[i]<<endl;
}

signed main(){
    cin.tie(0)->sync_with_stdio(0);
    int T=1; //cin>>T;
    while(T--) solve();
    return 0;
}
```

