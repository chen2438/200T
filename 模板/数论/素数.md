## 线性筛素数

```cpp
//#pragma GCC optimize(2)
//clock_t st=clock();
#include<bits/stdc++.h>
#define abss(x) ((x)>(0)?(x):(-1)*(x))
#define maxs(a,b) ((a)>(b)?(a):(b))
#define mins(a,b) ((a)<(b)?(a):(b))
#define FOR(i,a,b) for(int i=(a);i<=(b);++i)
#define ROF(i,a,b) for(int i=(a);i>=(b);--i)
#define mem(a) memset(a,0,sizeof(a))
const int INF (1<<30);
const int inf (-1<<30);
using namespace std;

const int maxn=1e8+7,maxm=6e6;
bool isPrime[maxn];
int Prime[maxm],cnt=0;

void GetPrime(int n){//数据范围[1,n]
	memset(isPrime,1,sizeof(isPrime));
	isPrime[1]=0;

	FOR(i,2,n){
		if(isPrime[i])//没被筛掉 
			Prime[++cnt]=i;//i成为下一个素数
			
		for(int j=1;j<=cnt and i*Prime[j]<=n;j++){
			isPrime[i*Prime[j]]=0;
			if(i%Prime[j]==0) break;
		}
	}
}//素数被标记为1，合数被标记为0

int main(){
	int n,q,k;
	cin>>n>>q;
	GetPrime(n);
	while(q--){
		scanf("%d",&k);
		printf("%d\n",Prime[k]);
	}
	return 0;
}
```

## AcWing 4268. 性感素数

https://www.acwing.com/problem/content/4271/

![image-20220702120633169](https://nme-200t.oss-cn-hangzhou.aliyuncs.com/template/202207021206226.png)

```cpp
#include <bits/stdc++.h>
using namespace std;

bool is_prime(int x){
    if (x < 2) return false;
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0) return false;
    return true;
}

int main(){
    int n;cin >> n;
    for (int i = n - 6; i <= n + 6; i += 12)
        if (is_prime(i) && is_prime(n)){
            cout << "Yes" << endl;
            cout << i << endl;
            exit(0);
        }
    for (int i = n + 1; ; i ++ )
        if ( is_prime(i) and (is_prime(i - 6) or is_prime(i + 6)) ){
            cout << "No" << endl;
            cout << i << endl;
            exit(0);
        }
    return 0;
}
```

