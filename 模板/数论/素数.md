## 线性筛素数

```cpp
#include<bits/stdc++.h>
#define FOR(i,a,b) for(int i=(a);i<=(b);++i)
using namespace std;

const int maxn=1e8+7,maxm=6e6;
bool isPrime[maxn];
int Prime[maxm],tot=0;

void GetPrime(int n){//筛[1,n]的素数
    //Prime[i]存第i个素数
	memset(isPrime,1,sizeof(isPrime));
	isPrime[1]=0;
	FOR(i,2,n){
		if(isPrime[i])//没被筛掉 
			Prime[++tot]=i;//i成为下一个素数
		for(int j=1; j<=tot and i*Prime[j]<=n; j++){
			isPrime[i*Prime[j]]=0;
			if(i%Prime[j]==0) break;
		}
	}
}

int main(){
	int n,q,k;
	cin>>n>>q;
	GetPrime(n);
	while(q--){
		scanf("%d",&k);
		printf("%d\n",Prime[k]);
	}
	return 0;
}
```

## AcWing 4268. 性感素数

https://www.acwing.com/problem/content/4271/

![image-20220702120633169](https://nme-200t.oss-cn-hangzhou.aliyuncs.com/template/202207021206226.png)

```cpp
#include <bits/stdc++.h>
using namespace std;

bool is_prime(int x){
    if (x < 2) return false;
    for (int i = 2; i <= x / i; i ++ )
        if (x % i == 0) return false;
    return true;
}

int main(){
    int n;cin >> n;
    for (int i = n - 6; i <= n + 6; i += 12)
        if (is_prime(i) && is_prime(n)){
            cout << "Yes" << endl;
            cout << i << endl;
            exit(0);
        }
    for (int i = n + 1; ; i ++ )
        if ( is_prime(i) and (is_prime(i - 6) or is_prime(i + 6)) ){
            cout << "No" << endl;
            cout << i << endl;
            exit(0);
        }
    return 0;
}
```

